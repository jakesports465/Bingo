<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DanQ Bingo Card</title>
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Anton', sans-serif;
      background: linear-gradient(135deg, #1c1c1c, #2a2a2a);
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 2em 1em;
    }

    h1 {
      font-size: 2.2em;
      margin-bottom: 1em;
      color: #ffffff;
      text-shadow: 2px 2px 4px #000;
    }

    table {
      border-collapse: separate;
      border-spacing: 6px;
      margin: 0 auto;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }

    tr {
      display: flex;
    }

    td {
      flex: 1;
      width: 80px;
      height: 80px;
      aspect-ratio: 1 / 1;
      border: 2px solid #e0e0e0;
      text-align: center;
      vertical-align: middle;
      font-size: clamp(8px, 1.3vw, 14px);
      padding: 4px;
      cursor: pointer;
      background: linear-gradient(to bottom, #2a2a2a, #3b3b3b);
      color: #d4e6f4;
      border-radius: 6px;
      box-shadow: inset -2px -2px 6px rgba(255,255,255,0.1), inset 2px 2px 6px rgba(0,0,0,0.6);
      transition: all 0.2s ease;
      word-wrap: break-word;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    td span {
      display: block;
      width: 100%;
      line-height: 1.2;
    }

    td:hover {
      background: linear-gradient(to bottom, #384b5f, #2e3f52);
    }

    td.marked,
    .free {
      background: linear-gradient(to bottom, #3a8dd0, #2a6ba5) !important;
      color: #ffffff;
      font-weight: bold;
      box-shadow: inset -2px -2px 6px rgba(255,255,255,0.1), inset 2px 2px 6px rgba(0,0,0,0.7);
    }

    @media (max-width: 600px) {
      tr {
        flex-direction: row;
      }

      td {
        width: 50px;
        height: 50px;
        font-size: clamp(6px, 2vw, 10px);
        padding: 2px;
      }
    }
  </style>
</head>
<body>
  <h1>DanQ8000 Stream Bingo</h1>
  <div id="cards"></div>

  <script>
    const defaultOptions = [
      "70s or 80s mentioned by John",
      "Sports mentioned by Jake",
      "Fox answers for Dan",
      "John says \"Dan Rocks\"",
      "Jake mentions having a meeting",
      "Beer mentioned by John",
      "Dan shrieks",
      "What game is this?",
      "What difficulty is this?",
      "Someone in chat complains about the team Dan chose",
      "Super Chat Sent",
      "Member gifted",
      "John has a typo",
      "Ham is meat",
      "You know they dead",
      "Oh wow appreciate the...",
      "Nipples mentioned by Dan",
      "PB&J mentioned by John",
      "Dan does an English accent",
      "John shares a life story",
      "Someone in chat says they found Dan through KOTOR",
      "What would you rate this game?",
      "Someone sends a no context message",
      "Dan quotes random movie",
      "No early access?",
      "Dan are you going to play 'X' game?",
      "Dan gets scared",
      "Someone doesn't understand time zones",
      "Dan sings a song",
      "John is behind in stream",
      "Someone keeps asking same question",
      "Member goal reached",
      "One of Dan's cats appears/mentioned on stream",
      "Dan wearing Oilers gear",
      "Nightbot warns someone for using all caps",
      "Dan adjusts the graphics settings more than once",
      "What is this game about?",
      "Someone tells Dan/chat about their day unprompted",
      "It's my birthday",
      "Its some random persons birthday",
      "Someone asks Dan to play a game he already has",
      "Dan makes a pun"
    ];

    function createCard(words) {
      const selected = words.slice(0, 24);
      let i = 0;
      let table = '<table>';
      for (let r = 0; r < 5; r++) {
        table += '<tr>';
        for (let c = 0; c < 5; c++) {
          const index = r * 5 + c;
          if (r === 2 && c === 2) {
            table += '<td class="free"><span>FREE</span></td>';
          } else {
            const word = selected[i++];
            const marked = getMarkedCells().includes(index) ? 'marked' : '';
            table += `<td data-index="${index}" onclick="toggleMarked(this)" class="${marked}"><span>${word}</span></td>`;
          }
        }
        table += '</tr>';
      }
      table += '</table>';
      return table;
    }

    function getUserDailySeed() {
      const today = new Date().toISOString().slice(0, 10);
      const key = `bingo-seed-${today}`;
      let seed = localStorage.getItem(key);
      if (!seed) {
        seed = Math.floor(Math.random() * 1000000000);
        localStorage.setItem(key, seed);
      }
      return parseInt(seed, 10);
    }

    function seededShuffle(array, seed) {
      let random = mulberry32(seed);
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function mulberry32(a) {
      return function() {
        var t = a += 0x6D2B79F5;
        t = Math.imul(t ^ t >>> 15, t | 1);
        t ^= t + Math.imul(t ^ t >>> 7, t | 61);
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
      }
    }

    function toggleMarked(cell) {
      cell.classList.toggle('marked');
      const index = parseInt(cell.getAttribute('data-index'));
      const today = new Date().toISOString().slice(0, 10);
      const key = `marked-cells-${today}`;
      let marked = getMarkedCells();
      if (cell.classList.contains('marked')) {
        if (!marked.includes(index)) marked.push(index);
      } else {
        marked = marked.filter(i => i !== index);
      }
      localStorage.setItem(key, JSON.stringify(marked));
    }

    function getMarkedCells() {
      const today = new Date().toISOString().slice(0, 10);
      const key = `marked-cells-${today}`;
      const marked = localStorage.getItem(key);
      return marked ? JSON.parse(marked) : [];
    }

    function generateDailyCard() {
      const seed = getUserDailySeed();
      const words = [...defaultOptions];
      seededShuffle(words, seed);
      const html = createCard(words);
      document.getElementById('cards').innerHTML = html;
    }

    window.onload = generateDailyCard;
  </script>
</body>
</html>
